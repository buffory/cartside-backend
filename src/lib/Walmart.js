import Scraper from './Scraper.js'
import { HttpsProxyAgent } from 'https-proxy-agent';

const SEARCH_ENDPOINT = 'https://www.walmart.com/search?q={{query}}';
const proxyAgent = new HttpsProxyAgent('http://170.106.106.138:13001');


const url = "https://www.walmart.com/orchestra/snb/graphql/Search/8515eedb70aec68b32c39922f1806f0cc84c0f485e5474590dc0238537ece614/search?variables=%7B%22id%22%3A%22%22%2C%22dealsId%22%3A%22%22%2C%22query%22%3A%22{{query}}%22%2C%22nudgeContext%22%3A%22%22%2C%22page%22%3A1%2C%22prg%22%3A%22desktop%22%2C%22catId%22%3A%22%22%2C%22facet%22%3A%22%22%2C%22sort%22%3A%22best_match%22%2C%22rawFacet%22%3A%22%22%2C%22seoPath%22%3A%22%22%2C%22ps%22%3A40%2C%22limit%22%3A40%2C%22ptss%22%3A%22%22%2C%22trsp%22%3A%22%22%2C%22beShelfId%22%3A%22%22%2C%22recall_set%22%3A%22%22%2C%22module_search%22%3A%22%22%2C%22min_price%22%3A%22%22%2C%22max_price%22%3A%22%22%2C%22storeSlotBooked%22%3A%22%22%2C%22additionalQueryParams%22%3A%7B%22hidden_facet%22%3Anull%2C%22translation%22%3Anull%2C%22isMoreOptionsTileEnabled%22%3Atrue%2C%22isGenAiEnabled%22%3Atrue%2C%22rootDimension%22%3A%22%22%2C%22altQuery%22%3A%22%22%2C%22selectedFilter%22%3A%22%22%7D%2C%22searchArgs%22%3A%7B%22query%22%3A%22{{query}}%22%2C%22cat_id%22%3A%22%22%2C%22prg%22%3A%22desktop%22%2C%22facet%22%3A%22%22%7D%2C%22ffAwareSearchOptOut%22%3Afalse%2C%22fitmentFieldParams%22%3A%7B%22powerSportEnabled%22%3Atrue%2C%22dynamicFitmentEnabled%22%3Atrue%2C%22extendedAttributesEnabled%22%3Atrue%7D%2C%22fitmentSearchParams%22%3A%7B%22id%22%3A%22%22%2C%22dealsId%22%3A%22%22%2C%22query%22%3A%22{{query}}%22%2C%22nudgeContext%22%3A%22%22%2C%22page%22%3A1%2C%22prg%22%3A%22desktop%22%2C%22catId%22%3A%22%22%2C%22facet%22%3A%22%22%2C%22sort%22%3A%22best_match%22%2C%22rawFacet%22%3A%22%22%2C%22seoPath%22%3A%22%22%2C%22ps%22%3A40%2C%22limit%22%3A40%2C%22ptss%22%3A%22%22%2C%22trsp%22%3A%22%22%2C%22beShelfId%22%3A%22%22%2C%22recall_set%22%3A%22%22%2C%22module_search%22%3A%22%22%2C%22min_price%22%3A%22%22%2C%22max_price%22%3A%22%22%2C%22storeSlotBooked%22%3A%22%22%2C%22additionalQueryParams%22%3A%7B%22hidden_facet%22%3Anull%2C%22translation%22%3Anull%2C%22isMoreOptionsTileEnabled%22%3Atrue%2C%22isGenAiEnabled%22%3Atrue%2C%22rootDimension%22%3A%22%22%2C%22altQuery%22%3A%22%22%2C%22selectedFilter%22%3A%22%22%7D%2C%22searchArgs%22%3A%7B%22query%22%3A%22{{query}}%22%2C%22cat_id%22%3A%22%22%2C%22prg%22%3A%22desktop%22%2C%22facet%22%3A%22%22%7D%2C%22ffAwareSearchOptOut%22%3Afalse%2C%22cat_id%22%3A%22%22%2C%22_be_shelf_id%22%3A%22%22%7D%2C%22enableFashionTopNav%22%3Afalse%2C%22enableRelatedSearches%22%3Atrue%2C%22enablePortableFacets%22%3Atrue%2C%22enableFacetCount%22%3Atrue%2C%22fetchMarquee%22%3Atrue%2C%22fetchSkyline%22%3Atrue%2C%22fetchGallery%22%3Afalse%2C%22fetchSbaTop%22%3Atrue%2C%22fetchSBAV1%22%3Afalse%2C%22enableAdsPromoData%22%3Afalse%2C%22fetchDac%22%3Afalse%2C%22tenant%22%3A%22WM_GLASS%22%2C%22enableMultiSave%22%3Afalse%2C%22enableInStoreShelfMessage%22%3Afalse%2C%22enableSellerType%22%3Afalse%2C%22enableAdditionalSearchDepartmentAnalytics%22%3Afalse%2C%22enableFulfillmentTagsEnhacements%22%3Afalse%2C%22enableRxDrugScheduleModal%22%3Afalse%2C%22enablePromoData%22%3Atrue%2C%22enableSignInToSeePrice%22%3Afalse%2C%22enablePromotionMessages%22%3Afalse%2C%22enableItemLimits%22%3Afalse%2C%22enableCanAddToList%22%3Afalse%2C%22enableIsFreeWarranty%22%3Afalse%2C%22enableShopSimilarBottomSheet%22%3Afalse%2C%22pageType%22%3A%22SearchPage%22%7D"
const headers = {
    "accept": "application/json",
    "accept-language": "en-US",
    "baggage": "trafficType=customer,deviceType=desktop,renderScope=CSR,webRequestSource=Browser,pageName=searchResults,isomorphicSessionId=v7JPckwMeeuLJrpJTQFjI,renderViewId=dc3aba74-2744-46a4-8eb1-b009df4bf4d6",
    "content-type": "application/json",
    "downlink": "10",
    "dpr": "1",
    "priority": "u=1, i",
    "sec-ch-ua": "\"Not.A/Brand\";v=\"99\", \"Chromium\";v=\"136\"",
    "sec-ch-ua-mobile": "?0",
    "sec-ch-ua-platform": "\"Linux\"",
    "sec-fetch-dest": "empty",
    "sec-fetch-mode": "cors",
    "sec-fetch-site": "same-origin",
    "tenant-id": "elh9ie",
    "traceparent": "00-1830d278f01bda5b33db96f1daeddba1-23aebc1872a87e79-00",
    "wm_mp": "true",
    "wm_page_url": "https://www.walmart.com/search?q={{query}}",
    "wm_qos.correlation_id": "iUoj9V6v23toZYWHsAQ29fULLrdMNSYlWb6m",
    "x-apollo-operation-name": "Search",
    "x-enable-server-timing": "1",
    "x-latency-trace": "1",
    "x-o-bu": "WALMART-US",
    "x-o-ccm": "server",
    "x-o-correlation-id": "iUoj9V6v23toZYWHsAQ29fULLrdMNSYlWb6m",
    "x-o-gql-query": "query Search",
    "x-o-mart": "B2C",
    "x-o-platform": "rweb",
    "x-o-platform-version": "usweb-1.190.1-24accd095764d5e50e48d8fdb38d686a6ef22a4f-3211741r",
    "x-o-segment": "oaoh",
    "cookie": "_pxvid=c4cfa232-0b3e-11f0-9ad0-7a24a777116a; adblocked=false; ACID=cb9f521f-e8e9-4e1c-8a26-9ed427e9cce1; _m=9; assortmentStoreId=510; hasACID=true; hasLocData=1; abqme=true; vtc=SYOZLoKU2DXCK__RIruXeM; _pxhd=96c399aa535e10585726721b962c42ff2bf72fe2b834f6529f94e9d7cac26ebe:c5200190-0b3e-11f0-a62f-2addc6735fd7; io_id=98864dc9-8908-4b41-b17d-d33bec6612b7; _intlbu=false; _shcc=US; auth=MTAyOTYyMDE4ULbZ2jGmxPR3rDYn%2FbHTufETUH8HIAhDy1dalRcxyHkipsNGJEXZ%2Fd0yS9pPbscmiI7QSHavzwKoOs%2F7ei9gFGpsPMSm1ozGU70aohMmcVjfgLTU4N2DYBmpRdWV6kbb767wuZloTfhm7Wk2KcjygpySosImygUk1x1iKsdnk4%2BBH%2BwbgBwfw8NgwjAp5FvcvtelGOsV6nNMvy2btAR1BFW6RtfekOTLEnP6TjKn%2Bf4UMk70P8glgOEpLOprhDfMWpzMbgzyqWg6MoSOREDGWkM%2BOUpRvcX84rQrL5NbCOY%2FJit0n3kO2%2F4HYcQErkp4i86r9FWgfnWBMyPxjaXsSnizHnVcZQEVZBFVi5eKkszMqDhlIscSpNkcY%2BHmBGz0Lx%2FSP%2F9l1ybhHTJIfJi2sUjyrOXbKKhH072NS%2FW0j%2FU%3D; locDataV3=eyJpc0RlZmF1bHRlZCI6ZmFsc2UsImlzRXhwbGljaXQiOmZhbHNlLCJpbnRlbnQiOiJTSElQUElORyIsInBpY2t1cCI6W3sibm9kZUlkIjoiNTEwIiwiZGlzcGxheU5hbWUiOiJHYWluZXN2aWxsZSBTdXBlcmNlbnRlciIsImFkZHJlc3MiOnsicG9zdGFsQ29kZSI6IjMwNTA0IiwiYWRkcmVzc0xpbmUxIjoiNDAwIFNIQUxMT1dGT1JEIFJEIE5XIiwiY2l0eSI6IkdhaW5lc3ZpbGxlIiwic3RhdGUiOiJHQSIsImNvdW50cnkiOiJVUyJ9LCJnZW9Qb2ludCI6eyJsYXRpdHVkZSI6MzQuMjkxNzQ5LCJsb25naXR1ZGUiOi04My44NTA1Mjl9LCJzY2hlZHVsZWRFbmFibGVkIjp0cnVlLCJ1blNjaGVkdWxlZEVuYWJsZWQiOnRydWUsInN0b3JlSHJzIjoiMDY6MDAtMjM6MDAiLCJhbGxvd2VkV0lDQWdlbmNpZXMiOlsiR0EiXSwic3VwcG9ydGVkQWNjZXNzVHlwZXMiOlsiQUNDX0lOR1JPVU5EIiwiUElDS1VQX0NVUkJTSURFIiwiUElDS1VQX0lOU1RPUkUiLCJQSUNLVVBfU1BFQ0lBTF9FVkVOVCIsIlBJQ0tVUF9CQUtFUlkiLCJBQ0MiXSwidGltZVpvbmUiOiJBbWVyaWNhL05ld19Zb3JrIiwic3RvcmVCcmFuZEZvcm1hdCI6IldhbG1hcnQgU3VwZXJjZW50ZXIiLCJzZWxlY3Rpb25UeXBlIjoiTFNfU0VMRUNURUQifSx7Im5vZGVJZCI6IjM2MjcifSx7Im5vZGVJZCI6IjI2OTkifSx7Im5vZGVJZCI6IjI3MzEifSx7Im5vZGVJZCI6IjM3ODYifSx7Im5vZGVJZCI6IjM4NzQifSx7Im5vZGVJZCI6IjEzMTQifSx7Im5vZGVJZCI6IjcxODUifSx7Im5vZGVJZCI6IjUyMCJ9XSwic2hpcHBpbmdBZGRyZXNzIjp7ImxhdGl0dWRlIjozNC4yNTg4LCJsb25naXR1ZGUiOi04My43ODUyLCJwb3N0YWxDb2RlIjoiMzA1MDciLCJjaXR5IjoiR2FpbmVzdmlsbGUiLCJzdGF0ZSI6IkdBIiwiY291bnRyeUNvZGUiOiJVU0EiLCJnaWZ0QWRkcmVzcyI6ZmFsc2UsInRpbWVab25lIjoiQW1lcmljYS9OZXdfWW9yayIsImFsbG93ZWRXSUNBZ2VuY2llcyI6WyJHQSJdfSwiYXNzb3J0bWVudCI6eyJub2RlSWQiOiI1MTAiLCJkaXNwbGF5TmFtZSI6IkdhaW5lc3ZpbGxlIFN1cGVyY2VudGVyIiwiaW50ZW50IjoiUElDS1VQIn0sImluc3RvcmUiOmZhbHNlLCJkZWxpdmVyeSI6eyJub2RlSWQiOiI1MTAiLCJkaXNwbGF5TmFtZSI6IkdhaW5lc3ZpbGxlIFN1cGVyY2VudGVyIiwiYWRkcmVzcyI6eyJwb3N0YWxDb2RlIjoiMzA1MDQiLCJhZGRyZXNzTGluZTEiOiI0MDAgU0hBTExPV0ZPUkQgUkQgTlciLCJjaXR5IjoiR2FpbmVzdmlsbGUiLCJzdGF0ZSI6IkdBIiwiY291bnRyeSI6IlVTIn0sImdlb1BvaW50Ijp7ImxhdGl0dWRlIjozNC4yOTE3NDksImxvbmdpdHVkZSI6LTgzLjg1MDUyOX0sInR5cGUiOiJERUxJVkVSWSIsInNjaGVkdWxlZEVuYWJsZWQiOmZhbHNlLCJ1blNjaGVkdWxlZEVuYWJsZWQiOmZhbHNlLCJhY2Nlc3NQb2ludHMiOlt7ImFjY2Vzc1R5cGUiOiJERUxJVkVSWV9BRERSRVNTIn1dLCJpc0V4cHJlc3NEZWxpdmVyeU9ubHkiOmZhbHNlLCJhbGxvd2VkV0lDQWdlbmNpZXMiOlsiR0EiXSwic3VwcG9ydGVkQWNjZXNzVHlwZXMiOlsiREVMSVZFUllfQUREUkVTUyIsIkFDQyJdLCJ0aW1lWm9uZSI6IkFtZXJpY2EvTmV3X1lvcmsiLCJzdG9yZUJyYW5kRm9ybWF0IjoiV2FsbWFydCBTdXBlcmNlbnRlciIsInNlbGVjdGlvblR5cGUiOiJMU19TRUxFQ1RFRCJ9LCJpc2dlb0ludGxVc2VyIjpmYWxzZSwibXBzIjpbIjE1MjE3MDAiLCIxNTIwMzg0IiwiMTUyMDEyOCIsIjE1MTg4OTQiLCIxNTE5OTkwIiwiMTUxOTk0OSIsIjE1MTg4NTciLCIxNTE4ODg0IiwiMTUyMDEzMSIsIjE1MjA3NTAiLCIxNTE4MzE5IiwiMTUxODcyNyIsIjE1MTg3NzkiLCIxNTIxMjI1IiwiMTUyMTAzNCIsIjE1MjA5NDEiLCIxNTIyNzk0IiwiMTUyMjcwNiIsIjE1MTg1NTUiLCIxNTE4NTY0IiwiMTUyMTQ0MiIsIjE1MjE1NTUiLCIxNTE4NjkzIiwiMTUyMzI1MCIsIjE1MjI3MTAiLCIxNTIyOTI4IiwiMTUyMTE4MiIsIjE1MTk4OTUiLCIxNTIyOTQxIiwiMTUxOTk4MyIsIjE1MjI5NzkiLCIxNTIzOTIxIiwiMTUyMjcxOCIsIjE1MjI3MDgiLCIxNTE4Nzg4IiwiMTUyMjcxMyIsIjE1MjI5MDQiLCIxNTE5ODkxIiwiMTUxODUxMCIsIjE1MTk5NTAiLCIxNTIyODMyIiwiMTUxODc4MSIsIjE1MTg4NTYiLCIxNTIyOTgxIiwiMTUyMDA2MSIsIjE1MjI3MDUiLCIxNTE4MzEzIiwiMTUxODkwOSIsIjE1MjI5NzYiLCIxNTIwODA4Il0sIm1wRGVsU3RvcmVDb3VudCI6MTgsInJlZnJlc2hBdCI6MTc0MzE0NjAyMDI4NSwidmFsaWRhdGVLZXkiOiJwcm9kOnYyOmNiOWY1MjFmLWU4ZTktNGUxYy04YTI2LTllZDQyN2U5Y2NlMSJ9; userAppVersion=usweb-1.190.1-24accd095764d5e50e48d8fdb38d686a6ef22a4f-3211741r; bstc=U3t2Mn613F5x5Eefvr3Yfc; mobileweb=0; xpth=x-o-mart%2BB2C~x-o-mverified%2Bfalse; xpa=0Yuzo|3VCVY|69a0j|DWA1K|NC__g|QNY8m|QphTZ|RUIbZ|T40yC|TuvkI|WflOZ|c5dxp|dJ_VA|dWYMK|fdm-7|gZWrW|h60LK|i3eO7|jM1ax|ktZl1|l-yEM|lu6gP|mYL-O|nm0Ud|pXvSG|xf36q|yAoIi|zObb3; exp-ck=DWA1K1NC__g1QphTZ1RUIbZ1T40yC1TuvkI2dJ_VA1fdm-71gZWrW1h60LK1l-yEM1lu6gP1mYL-O1nm0Ud3pXvSG1xf36q2yAoIi5zObb31; ak_bmsc=8AAF72FE76D741407B19107F37A6BF32~000000000000000000000000000000~YAAQk8hNFyCXxayVAQAACt1P2htbFv3nROaidoKymDgycT3PTydABUmHxLwHeR94mGpNyot592jXSsP5SMMMvMqRTfdxiAQN+gSbNGSPjhZDfL+DS9TDCaFCIFW4jdrgM4ELTE47oTQpWpDpqlPwAP1XrkoGGVmol6ecsryqCwQb+orXIbSfZ5uebR1pdLYLpHQl2za6lhqBGMQixIViaIcEvdITJHhheNeFNetoQFN1SgAB/efQ8Jcis5vkCjeWpiHBm5UqCG1XdV/UjmUPwBmG3AbN7XIkbRTlPrYQ9aJGrxutcSbmU+zl028tojkzsQbR0sG8IhAqcuSofwJp1gtFBgsG0+LriuRY6rB0aPpY2SH+qfHU4T5JXYmJ/rcU2WwKpcguhvmp; _astc=10ea5f13a10e12951a6e9fdb27adfdab; pxcts=e430651e-0b71-11f0-9b6a-c33c16e86541; xpm=1%2B1743124420%2BSYOZLoKU2DXCK__RIruXeM~%2B0; wmlh=22dc4876cfe57d459ecb6024fe360785beb362b7010912e24c6e417a0e137be5; AID=wmlspartner=0:reflectorid=0000000000000000000000:lastupd=1743124436254; xptwj=uz:7d7b7ebd714e5147d54c:svtPLcpwODw1FoBKuVsXf/qv8dr9YoD3ea7sloTGTZS1nwAR32SMdlx3PWjlQQXBrWhiwvv2elrOjYMNLJQM0WjAMLyaVs4VG5Psy+RY54iZePEnu/bfAS/V39g+TDxAp6sHPHvlFZTtDWQamGhUKS6dCnh4NUZTfwja0+d76Q==; bm_mi=9C23A328887D453CD923972A262194E4~YAAQk8hNF1iaxayVAQAALxxQ2hvgAMUjsHiNv9bZl4dunJgq7FGVTbYNILJXg6bMjPXPMY8anefmucZX58YCNkY49LN4xNYvMoXr/JKxxWKN2R5AXZUjpbNsqrFt/KuqJ/QJq+ePtVlhKuU/+OyipWA08ck76RApdoi96d1Lm+b72B9MnZ2pGV0HmObznEnCv7MujPOPuM25FHpqjMB0f8tJVOB18k2n5X9AVV5BOkuD3Rmf/k0jai6wjYQOA7zZ8e/5ZoSbCsfNM8oyu7zd9QBezJRnSjW9W48llJAZ8t2oxk5+VLp6zahrJwzcDD4PrLdH+lo=~1; _px3=d1901c07d5f6d3ab636c3f20881e06972e80626bac2fbb68fef19a9d9e71ad3c:ozSYiSPN0CVCzcWqhYzU9vve4jKQirWhkrcepZTLDs3zREnuI79xVgH+kGSIIy6zPorqwOf7AOhq/q8gMsTTTw==:1000:EMdipBuRhAsD9kdkPvzSyCJfO8LdnBlnx1j9FsZfhjou6onut1K62hq+Z6nDr3IhXtQ/mdSz2DoJdxFdamQB+rbDx5wpCSQAmtGviAm4uaclYOp0Ke9VjTunM2UY3GLM6VZGpLK9sfzhbk/N/qX3uEz3db8EBa/Yz8T45/RPXWXV01iITNyb2X50L56BdmI2msFizm7igq3FTGL06X9l2bNT0bDRIlanDPiXGb6crMk=; locGuestData=eyJpbnRlbnQiOiJTSElQUElORyIsImlzRXhwbGljaXQiOmZhbHNlLCJzdG9yZUludGVudCI6IlBJQ0tVUCIsIm1lcmdlRmxhZyI6ZmFsc2UsImlzRGVmYXVsdGVkIjpmYWxzZSwicGlja3VwIjp7Im5vZGVJZCI6IjUxMCIsInRpbWVzdGFtcCI6MTc0MzEwMjQ2NzI1OCwic2VsZWN0aW9uVHlwZSI6IkxTX1NFTEVDVEVEIiwic2VsZWN0aW9uU291cmNlIjoiSVBfU05JRkZFRF9CWV9MUyJ9LCJzaGlwcGluZ0FkZHJlc3MiOnsidGltZXN0YW1wIjoxNzQzMTAyNDY3MjU4LCJ0eXBlIjoicGFydGlhbC1sb2NhdGlvbiIsImdpZnRBZGRyZXNzIjpmYWxzZSwicG9zdGFsQ29kZSI6IjMwNTA3IiwiZGVsaXZlcnlTdG9yZUxpc3QiOlt7Im5vZGVJZCI6IjUxMCIsInR5cGUiOiJERUxJVkVSWSIsInRpbWVzdGFtcCI6MTc0MzA5OTY3MDg2NywiZGVsaXZlcnlUaWVyIjpudWxsLCJzZWxlY3Rpb25UeXBlIjoiTFNfU0VMRUNURUQiLCJzZWxlY3Rpb25Tb3VyY2UiOiJJUF9TTklGRkVEX0JZX0xTIn1dLCJjaXR5IjoiR2FpbmVzdmlsbGUiLCJzdGF0ZSI6IkdBIn0sInBvc3RhbENvZGUiOnsidGltZXN0YW1wIjoxNzQzMTAyNDY3MjU4LCJiYXNlIjoiMzA1MDcifSwibXAiOltdLCJtc3AiOnsibm9kZUlkcyI6WyIzNjI3IiwiMjY5OSIsIjI3MzEiLCIzNzg2IiwiMzg3NCIsIjEzMTQiLCI3MTg1IiwiNTIwIl0sInRpbWVzdGFtcCI6MTc0MzEwMjQ2NzI1MX0sIm1wcyI6WyIxNTIxNzAwIiwiMTUyMDM4NCIsIjE1MjAxMjgiLCIxNTE4ODk0IiwiMTUxOTk5MCIsIjE1MTk5NDkiLCIxNTE4ODU3IiwiMTUxODg4NCIsIjE1MjAxMzEiLCIxNTIwNzUwIiwiMTUxODMxOSIsIjE1MTg3MjciLCIxNTE4Nzc5IiwiMTUyMTIyNSIsIjE1MjEwMzQiLCIxNTIwOTQxIiwiMTUyMjc5NCIsIjE1MjI3MDYiLCIxNTE4NTU1IiwiMTUxODU2NCIsIjE1MjE0NDIiLCIxNTIxNTU1IiwiMTUxODY5MyIsIjE1MjMyNTAiLCIxNTIyNzEwIiwiMTUyMjkyOCIsIjE1MjExODIiLCIxNTE5ODk1IiwiMTUyMjk0MSIsIjE1MTk5ODMiLCIxNTIyOTc5IiwiMTUyMzkyMSIsIjE1MjI3MTgiLCIxNTIyNzA4IiwiMTUxODc4OCIsIjE1MjI3MTMiLCIxNTIyOTA0IiwiMTUxOTg5MSIsIjE1MTg1MTAiLCIxNTE5OTUwIiwiMTUyMjgzMiIsIjE1MTg3ODEiLCIxNTE4ODU2IiwiMTUyMjk4MSIsIjE1MjAwNjEiLCIxNTIyNzA1IiwiMTUxODMxMyIsIjE1MTg5MDkiLCIxNTIyOTc2IiwiMTUyMDgwOCJdLCJtcERlbFN0b3JlQ291bnQiOjE4LCJzaG93TG9jYWxFeHBlcmllbmNlIjpmYWxzZSwic2hvd0xNUEVudHJ5UG9pbnQiOmZhbHNlLCJtcFVuaXF1ZVNlbGxlckNvdW50IjowLCJ2YWxpZGF0ZUtleSI6InByb2Q6djI6Y2I5ZjUyMWYtZThlOS00ZTFjLThhMjYtOWVkNDI3ZTljY2UxIn0%3D; com.wm.reflector=\"reflectorid:0000000000000000000000@lastupd:1743124441000@firstcreate:1743124420161\"; xptwg=2293136320:DDCA8EB0BC1550:2227B64:129BF93C:B7124A8:B4990C96:; akavpau_p2=1743125041~id=9ee28f0882f8ffc38e103dc69ea91692; if_id=FMEZARSFhm1s9eTkV5W7/IkMnIVn2MBNCKpd6VkZswIjSd1gZ3ejJ77oK1Vhb0fqfRmB6FAh9QFcqibltXRtZYRvH1u+fHa6PqDOMwFMUQtLhv/PHcFjck9Tare5CBFB8kyrt+e4go0CIvQui7OwcfBGaaeAX3hjaSDPBibnCHCfokgzNfobS8sMFpuWeeJyTXXfN+eMlR/aE7WsmlY9Ro3R79VC8O8WDwGq1MzgA547kBwqLhsS85Z3yWjXJrhdd+GIVBrzkL6fGpFcMRqv94UiAatb1kGRhllLnUPnH63zlBqne3GBGie7hAXZkwnl2scLkRYP0Hhq3wcK4lxvAT8KpKOeKA==; TS016ef4c8=0140bf8a74a6d607eea39b0509efee9d4c221459ce58d741a70fb0466719f068adcb8ada8f7e910a1f0c0bc8ee3dc4cf255ac38c00; TS01f89308=0140bf8a74a6d607eea39b0509efee9d4c221459ce58d741a70fb0466719f068adcb8ada8f7e910a1f0c0bc8ee3dc4cf255ac38c00; TS8cb5a80e027=0844835392ab2000602c647c5605067b3c909b892d4f0e67fc2af7cea70d08232d346761ca5b019d08b87b970d11300077811f00e3f1fd1cd1057caa2622eff1e1381b46de29ca66cb7a9cf07263a90443e4587a2f2a5161586bfef0b3baa249; _pxde=ceec986cee23cbdc8362823cde20142f41d0ef15c300c0e5126b3b75189c2cd4:eyJ0aW1lc3RhbXAiOjE3NDMxMjQ0Njk3MDJ9; xptc=_m%2B9~assortmentStoreId%2B510; TS012768cf=01f2963ec6f259a1ce65f7da54b9607593e9fc46dcbbea02393f629c582df0c15cb89483c63782fe1c97e7ae0714afeea36b1f56c2; TS01a90220=01f2963ec6f259a1ce65f7da54b9607593e9fc46dcbbea02393f629c582df0c15cb89483c63782fe1c97e7ae0714afeea36b1f56c2; TS2a5e0c5c027=08f8ee6d82ab20004ddf717f56146270b993258cedf11856b2d4e0b5c3f37bbd0ff33cd641193db408e6bcd502113000b3697c716f749b5a407719450a4c5a63e4c87c13027d92a651cd976c1a7d61a1f8fa4d04b63693f922dbf3ccb3a7c027; bm_sv=FACEC966B23C286AAF3CFAD766C65D43~YAAQk8hNF/+gxayVAQAATKJQ2hv/C2zQ73v+GftRL6VgU3wQo8m6L314y92ps8n8hcUCejVwvHGFc8t14WwS7A7xToDpkgbXc+Ogui9O1sCwWMRm1uznd8fSiyXP2s6QJfkyl3spVM0BqqAmbHSHHc2ub/W89gzHLwLGG3N2ZzbVvJkDoLQNx1SRgDrq77zYYb+ejL9OOPKLiYt0c8ST6qR65u6+JiurFnaR04Od3pX71KOUmPf9EE649Ix+DhbqmMU=~1",
    "Referer": "https://www.walmart.com/search?q={{query}}",
    "Referrer-Policy": "strict-origin-when-cross-origin"
};

const method = "GET";

class Walmart extends Scraper {
    constructor({ port }) {
        super({ port });
    }

    async intercept_query({ query }) {
        const request = await this.intercept_urls({ target: '', urls: [SEARCH_ENDPOINT.replace('{{query}}', query)] });
        console.log(request[0]); 
    }

    async query({ query }) {
        const nUrl = url.replace('{{query}}', `${query}`);
        Object.keys(headers).forEach(key => {
            if (headers[key].includes('{{query}}')) {
                headers[key].replace('{{query}}', `${query}`);
            }
        });

        const response = await fetch(nUrl, { headers, method, agent: proxyAgent });
        return await response.json();
    }

}

export default Walmart;

